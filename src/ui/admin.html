<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Time Tracker - Admin Dashboard</title>
  <meta http-equiv="Content-Security-Policy" content="script-src 'self';">
  <link rel="stylesheet" href="styles/main.css">
  <link rel="stylesheet" href="styles/admin.css">
</head>
<body>
  <div class="container">
    <header class="admin-header">
      <h1>Time Tracker Admin</h1>
      <div class="admin-controls">
        <button id="refresh-data-btn">Refresh Data</button>
        <button id="toggle-source-btn">Toggle Data Source</button>
        <button id="refresh-drive-btn">Refresh from Drive</button>
        <button id="clear-cache-btn">Clear Cache</button>
        <button id="back-to-app-btn">Back to Timer</button>
      </div>
    </header>
    
    <div class="admin-content">
      <!-- Data source indicator -->
      <div class="admin-section data-source-indicator">
        <div class="data-source-status">
          <p>Data Source: <span id="data-source-text">Loading...</span></p>
          <p>Last Sync: <span id="last-sync-text">Unknown</span></p>
          <div id="data-source-loading" class="loading-indicator hidden">
            <span class="loader"></span>
            <span>Loading from Drive...</span>
          </div>
        </div>
      </div>
      
      <!-- User selection section -->
      <div class="admin-section">
        <h2>Users</h2>
        <div class="user-select-container">
          <select id="user-select">
            <option value="all">Select a user</option>
            <!-- User options will be populated dynamically -->
          </select>
        </div>
      </div>
      
      <!-- Date range selection -->
      <div class="admin-section">
        <h2>Date Range</h2>
        <div class="date-range-container">
          <div class="date-input">
            <label for="date-from">From:</label>
            <input type="date" id="date-from">
          </div>
          <div class="date-input">
            <label for="date-to">To:</label>
            <input type="date" id="date-to">
          </div>
          <div class="date-presets">
            <button type="button" class="date-preset-btn" id="today-btn">Today</button>
            <button type="button" class="date-preset-btn" id="yesterday-btn">Yesterday</button>
            <button type="button" class="date-preset-btn" id="this-week-btn">This Week</button>
            <button type="button" class="date-preset-btn" id="last-week-btn">Last Week</button>
            <button type="button" class="date-preset-btn" id="this-month-btn">This Month</button>
            <button type="button" class="date-preset-btn" id="last-month-btn">Last Month</button>
            <button type="button" class="date-preset-btn" id="last-7-days-btn">Last 7 Days</button>
            <button type="button" class="date-preset-btn" id="last-30-days-btn">Last 30 Days</button>
          </div>
          <button id="apply-dates-btn">Apply</button>
        </div>
      </div>

      <div class="admin-section">
        <h2>Filters</h2>
        <div class="client-project-filter">
          <div>
            <label for="client-filter">Client:</label>
            <select id="client-filter" class="filter-select">
              <option value="all">All Clients</option>
              <!-- Client options will be populated dynamically -->
            </select>
          </div>
          <div>
            <label for="project-filter">Project:</label>
            <select id="project-filter" class="filter-select">
              <option value="all">All Projects</option>
              <!-- Project options will be populated dynamically -->
            </select>
          </div>
          <button id="apply-filters-btn" class="action-btn">Apply Filters</button>
        </div>
      </div>
      
      <!-- Time entries section -->
      <div class="admin-section">
        <h2>Time Entries</h2>
        <div class="admin-table-container">
          <table id="time-entries-table" class="admin-table">
            <thead>
              <tr>
                <th>Date</th>
                <th>User</th>
                <th>Client</th>
                <th>Project</th>
                <th>Start Time</th>
                <th>End Time</th>
                <th>Duration</th>
                <th>Screenshots</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <!-- Time entries will be populated dynamically -->
              <tr class="placeholder-row">
                <td colspan="9">Select a user and date range to view time entries</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      
      <!-- Screenshots section -->
      <div class="admin-section">
        <h2>Screenshots</h2>
        <div id="screenshots-container" class="screenshots-grid">
          <!-- Screenshots will be populated dynamically -->
          <div class="placeholder-message">Select a time entry to view screenshots</div>
        </div>
      </div>
      
      <!-- Reports section -->
      <div class="admin-section">
        <h2>Reports</h2>
        <div class="reports-container">
          <div class="report-buttons">
            <button id="user-report-btn">User Report</button>
            <button id="client-report-btn">Client Report</button>
            <button id="project-report-btn">Project Report</button>
            <button id="export-csv-btn">Export to CSV</button>
          </div>
          <div id="report-results" class="report-results">
            <!-- Report results will be displayed here -->
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Screenshot modal -->
  <div id="screenshot-modal" class="modal">
    <div class="modal-content">
      <span class="close-modal">&times;</span>
      <h3>Screenshot Details</h3>
      <div class="screenshot-details">
        <div><strong>Date:</strong> <span id="screenshot-date"></span></div>
        <div><strong>Time:</strong> <span id="screenshot-time"></span></div>
        <div><strong>User:</strong> <span id="screenshot-user"></span></div>
        <div><strong>Project:</strong> <span id="screenshot-project"></span></div>
        <div><strong>Source:</strong> <span id="screenshot-source"></span></div>
      </div>
      <div class="screenshot-image-container">
        <img id="screenshot-full-image" src="" alt="Screenshot">
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/admin.js"></script>
</body>
</html>